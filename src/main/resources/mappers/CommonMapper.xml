<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="CommonMapper">

     <!--  MySql 페이징 -->
     <sql id="paging">
     	LIMIT
     		#{paginationInfo.firstRecordIndex}, #{recordsPerPage}		    	
     </sql>
     
     <!-- MySQL 검색 -->
     <sql id="search">
     	<!-- 검색 키워드가 있을 때 -->
     	<if test="searchKeyword != null and searchKeyword != ''">
     		<choose>
     			<!-- 검색 유형이 있을 때 -->
     			<when test="searchType != null and searchType != ''">
     				<choose>
     					<when test="'insType'.equals(searchType)">
     						AND insType LIKE CONCAT('%', #{searchKeyword}, '%')
     					</when>
     					
     					<when test="'insCo'.equals(searchType)">
     						AND insCo LIKE CONCAT('%', #{searchKeyword}, '%')
     					</when>
     					
     					<when test="'contractNo'.equals(searchType)">
     						AND contractNo LIKE CONCAT ('%', #{searchKeyword}, '%')
     					</when>
     					
     					<when test="'contractor'.equals(searchType)">
     						AND contractor LIKE CONCAT ('%', #{searchKeyword}, '%')
     					</when>
     					
     					<when test="'prodName'.equals(searchType)">
     						AND prodName LIKE CONCAT ('%', #{searchKeyword}, '%')
     					</when>     					
     				</choose>
     			</when>
     			
     			<!-- 검색 유형이 없을 때 -->
     			<otherwise>
     				AND
     					(
     							insType LIKE CONCAT('%', #{searchKeyword}, '%')
     						 OR insCo LIKE CONCAT ('%', #{searchKeyword}, '%')
     						 OR contractNo LIKE CONCAT ('%', #{searchKeyword}, '%')
     						 OR contractor LIKE CONCAT ('%', #{searchKeyword}, '%')
     						 OR prodName LIKE CONCAT ('%', #{searchKeyword}, '%')
     					)
     			</otherwise>
     		</choose>
     	</if>
     </sql>		
</mapper>
